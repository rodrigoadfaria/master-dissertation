%% ------------------------------------------------------------------------- %%
\chapter{Related Work}
\label{cap:related-work}

There are a large number of works of skin detection based on color information and there are a couple of them comparing different techniques and classifiers, mainly from the point of view of performance, color models, skin color modeling and different datasets \citep{vezhnevets:03,kakumanu:07,mahmoodi:16}.

On different techniques, statistical models are those which estimate the probability that an observed pixel is associated with skin, based on a huge training dataset. One approach is the single histogram based Look-UP Table (LUT) that is capable to obtain the distribution of skin pixels in a particular color space, by using a set of training pixels \citep{mahmoodi:16}. Considering the RGB color model for instance, a histogram with 256 bins per channel - $256^3$ in total - can be constructed for further counting the probability (see Eq. \ref{eq:lut_probability}) of each possible RGB value \citep{jones:02}.

\begin{equation*}
    P(rgb) = \frac{\# counts~of~rgb}{total~counts}
    \label{eq:lut_probability}
\end{equation*}

In~\citet{jones:02}, the authors applied this technique to figure out the decision boundary of skin pixels distribution by using a $3$-dimensional histogram model constructed from approximately 2 billion pixels. Those pixels were collected from 18,696 images over the Internet to perform skin detection. First, visualization techniques were used to examine the shape of these distributions. Then, by examining the 3D histogram from several angles, \citet{jones:02} realized that its overall shape could be inferred.

So, two different histograms for skin and non-skin in the RGB color space were calculated. Using those histograms along with training data, a surprisingly accurate pixel-wise classifier was derived. The best performance at an error rate of 88\% was reached for histograms of size 32.

On the basis of the output of the skin detector, \citet{jones:02} also trained a classifier to determine whether a naked person is present or not in the scene. The features used from the output to create the feature vector were:
\begin{itemize}
    \item Percentage of pixels detected as skin
    \item Average probability of the skin pixels
    \item Size in pixels of the largest connected component of skin
    \item Number of connected components of skin
    \item Percent of colors with no entries in the skin and nonskin histograms
    \item Height of the image
    \item Width of the image
\end{itemize}

In the last step, 10,679 images were manually classified into 5,453 naked and 5,226 non-naked image sets to train a neural network classifier. The neural network outputs a number between 0 and 1, with 1 indicating a naked person in the image. The detection rate achieved was of 88\%, with a false alarm rate of 11.3\%.

Skin detection is sometimes used as a primary task for other applications. \citet{hsu:02} have embedded skin segmentation with the purpose to build a face detector application. The algorithm first performs a lighting compensation on the R, G, and B components of the pixels of the image. Then, these color corrected components are non-linearly transformed into YCbCr space. The skin pixels are detected using an elliptical skin model with Mahalanobis distance, assuming a Gaussian distribution of skin tone color in the color space.

The experiments have shown good skin detection results, around 96\% detection rate on HH1 MPEG7 video and 80\% on Champion datasets, which contain images with frontal, near-frontal, half-profile and profile
faces under varying backgrounds and illumination conditions. On the other hand, the results also showed a high false positive rate. This drawback is reduced further with facial feature detection procedure based on the spatial arrangement of the detected skin patches.

Another typical method explicitly defines, through a number of rules, the boundaries that delimit the grouping of skin pixels in some color space \citep{vezhnevets:03}. This was the approach adopted by \citet{kovac:03} in the RGB color space, obtaining a true positive rate of 90.66\%. Basically, to find out the skin cluster in the RGB color space, the skin color is determined with the following rules \citep{kovac:03}:

\begin{align*}
\text{Skin colour at uniform daylight illumination}\\
R > 95, G > 40, B > 20 \\
max(R, G, B) - min(R, G, B) > 15 \\
|R - G| > 15 \\
R > G \\
R > B
\end{align*}

\begin{align*}
\text{Skin colour at flashlight (light daylight) illumination}\\
R > 220, G > 210, B > 170 \\
|R - G| \leq 15 \\
R > B \\
G > B
\end{align*}

They~\citep{kovac:03} also performed experiments in comparison with \citet{hsu:02}, where only the chromaticity channels Cb and Cr from the YCbCr color space are used. The results showed that the performance of the classifier is inferior in relation to the approach using all the three channels. \citet{hsu:02} method indeed diminished the influence of noise in dark images, but in images that are captured under standard daylight illumination they label too many pixels as skin, decreasing the performance of the face detector by increasing the number of false positive pixels \citep{kovac:03}.

The key advantage of this method is the simplicity of skin detection rules that leads to the construction of a very fast classifier. On the other hand, achieving high recognition rates with this method is difficult because it is necessary to find a good color space and empirically appropriate decision rules~\citep{vezhnevets:03}.

Differently from~\citet{kovac:03}, the authors of~\citet{yogarajah:11} developed a technique where the thresholds defined in the rules are dynamically adapted. The method consists of detecting the region of the eye and extracting an elliptical region to delimit the corresponding face. A Sobel filter is applied to detect the edges of the resulting region which is subjected to a dilation in order to get the optimal non-smooth regions, (i.e. eyes and mouth). The resulting image is subtracted from the elliptical image. As a result, there is a more uniform skin region where the thresholds are calculated.

Every single pixel in the color image is classified as skin and non-skin, based on the calculated dynamic threshold values. When the algorithm detects multiple possible face regions in the image, a dynamic threshold is constructed for each of them and, subsequently submitted to perform skin segmentation on the whole image. Finally, a logical OR operation is applied in all of the segmented regions obtained as of each dynamic threshold~\citep{yogarajah:11}.

The technique was used as a preprocessing step for~\citet{tan:12} in a strategy combining a $2$-dimensional density histogram and a Gaussian model for skin color detection. The results showed an accuracy of 90.39\%.

\citet{naji:12} constructed an explicit classifier in the HSV color space for 4 different skin ethnic groups in parallel. After primitive segmentation, a rule-based region growth algorithm is applied, in which the output of the first layer is used as a seed, and then the final mask in other layers is constructed iteratively by neighboring skin pixels. The number of true positive pixels reported was of 96.5\%.

\citet{kawulok:13} combined global and local image information to construct a probability map that is used to generate the initial seed for spatial analysis of skin pixels. Seeds extracted using a local model are highly adapted to the image, which greatly improves the spatial analysis result.

Although color is not used directly in some skin detection approaches, it is one of the most decisive tools that affect the performance of algorithms \citep{mahmoodi:16}. Despite the performance of most skin detectors is directly related to the choice of color space, \citet{albiol:01} proved that the optimum performance of the skin classifiers is independent of the color space.

RGB is the most commonly used color space for storing and representing digital images, since the cameras are enabled to provide the images in such model. To reduce the influence of illumination, the RGB channels can be normalized and the third component can be removed, since it does not provide significant information \citep{kakumanu:07}. This characteristic led \citet{bergasa:00} to construct an adaptive and unsupervised Gaussian model to segment skin into the normalized RGB color space, using only the channels $r$ and $g$.

In~\citet{jayaram:04}, a comparative study using a Gaussian approach and a histogram in a dataset of 805 color images in 9 different color spaces has been performed. The results revealed that the absence of the luminance component, which means using only two channels of the color space, significantly impacts the performance as well as the selection of the color space. The best results were obtained in the SCT, HSI and CIELab color spaces with histogram approach.

In~\citet{chaves:10}, the authors compared the performance of 10 color spaces based on the $k$-means clustering algorithm on 15 images of the Aleix and Robert (AR) face image database \citep{ar-face-database:98}. According to the results obtained, the most appropriate color spaces for skin color detection are YCgCr, YDbDr and HSV.

In~\citet{kaur:12}, an algorithm similar to that proposed by \citet{kovac:03} have been implemented, where the boundaries that delimit the grouping of skin pixels are defined by explicit rules. After segmenting the image with the explicit rules, the algorithm also performs morphological and filtering operations to improve the accuracy of the method. The authors applied the algorithm in the YCbCr and CIELab color spaces, ignoring the Y and L luminance components, respectively. The results were more satisfactory when the algorithm was applied on CIELab. A similar technique was implemented in \citet{shaik:15} and \citet{kumar:15} in the HSV and YCbCr color spaces, the latter providing the best results in both.

Finally, in~\citet{brancati:17}, a novel rule-based skin detection method that works in the YCbCr color space based on correlation rules that evaluate the combinations of chrominance Cb, Cr values to identify the skin pixels depending on the shape and size of dynamically generated skin color clusters was proposed. Geometrically, the clusters create trapezoids in the YCb and YCr subspaces that reflect in the inversely proportional behavior of the chrominance components. The method was compared with six well known rule-based methods in literature outperforming them in terms of quantitative performance evaluation parameters. Moreover, the qualitative analysis shows that the method is very robust in critical scenarios.